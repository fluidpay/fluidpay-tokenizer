"use strict";(self["webpackChunkfluidpay_tokenizer"]=self["webpackChunkfluidpay_tokenizer"]||[]).push([[601],{507:function(t,e,n){n.d(e,{K:function(){return i}});const i="pub_0wUsHIlrkK1I6ADno5MfT10UjhR"},430:function(t,e,n){function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function a(t,e){if("object"!==i(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var a=n.call(t,e||"default");if("object"!==i(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function s(t){var e=a(t,"string");return"symbol"===i(e)?e:String(e)}function r(t,e,n){return e=s(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}n.d(e,{Z:function(){return u}});const o="{{formUrl}}",p="http://localhost:8082",l="/api/tokenizer";class u{constructor(t){if(r(this,"id",void 0),r(this,"apikey",void 0),r(this,"url",void 0),r(this,"amount",void 0),r(this,"iframe",void 0),r(this,"container",null),r(this,"settings",{id:"",apikey:"",amount:""}),r(this,"applePay",{btn:null}),r(this,"clickApplePay",(()=>{if(!ApplePaySession)return void console.warn("Apple Pay is not available");const t=this.settings?.payment?.applePay;if(!t)return void console.error("Apple Pay is missing from configuration");const e=["amex","chinaUnionPay","discover","interac","masterCard","privateLabel","visa","jcb","cartesBancaires","eftpos","electron","elo","maestro","vPay","mada"],n=new ApplePaySession(t.version||5,{countryCode:t.payment.countryCode,currencyCode:t.payment.currencyCode,total:t.payment.total,merchantCapabilities:t.payment.merchantCapabilities||["supports3DS"],supportedNetworks:t.payment.supportedNetworks||e,supportedCountries:t.payment.supportedCountries,lineItems:t.payment.lineItems,requiredBillingContactFields:t.payment.requiredBillingContactFields,requiredShippingContactFields:t.payment.requiredShippingContactFields});n.onvalidatemerchant=async e=>{fetch(`${this.url}/api/public/applepay/validatemerchant`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({PKeyCompany:t.key,AppleMerchantId:t.appleMerchantID,ValidationUrl:e.validationURL,domainName:t.domainName})}).then((t=>t.json())).then((t=>n.completeMerchantValidation(t))).catch((()=>{console.error("merchant validation failed"),n.completeMerchantValidation({error:"merchant validation failed"})}))},n.onpaymentauthorized=e=>{t.autoPay(e).then((t=>{this.submission({status:t}),"success"===t?n.completePayment(ApplePaySession.STATUS_SUCCESS):n.completePayment(ApplePaySession.STATUS_FAILURE)})).catch((()=>{n.completePayment(ApplePaySession.STATUS_FAILURE)}))};try{n.begin()}catch(i){console.error(i)}})),r(this,"onLoad",(()=>{})),r(this,"validCard",(()=>{})),r(this,"achOnChange",(()=>{})),r(this,"magStripeSwipe",(()=>{})),r(this,"onPaymentChange",(()=>{})),r(this,"submission",(()=>{})),r(this,"errorPass",(()=>{})),!t.apikey)throw new Error("apikey must be set!");this.apikey=t.apikey,this.url=t.url&&""!==t.url?t.url:o,t.amount&&(this.amount=t.amount),this.id=this.uuid(),"object"===typeof t.settings&&(this.settings=t.settings),t.onLoad&&(this.onLoad=t.onLoad),t.validCard&&(this.validCard=t.validCard),t.achOnChange&&(this.achOnChange=t.achOnChange),t.magStripeSwipe&&(this.magStripeSwipe=t.magStripeSwipe),t.onPaymentChange&&(this.onPaymentChange=t.onPaymentChange),t.submission&&(this.submission=t.submission),window.addEventListener("message",(t=>{this.messageListener(t)})),this.iframe=this.buildIframe(),this.waitForContainer(t.container,(t=>{if(!t)throw new Error("Could not find container");this.iframe.onload=()=>{this.settings.id=this.id,this.settings.apikey=this.apikey,this.settings.amount=this.amount,this.setSettings(this.settings),this.onLoad()},this.container=t,this.container.appendChild(this.iframe),this.initApplePay(t)}))}create(){}getApiKeyURL(){return this.getTokenizerURL()+"/"+this.apikey}getTokenizerURL(){const t=this.url;return window.location.href.includes("localhost")?p.replace(/\/$/,"")+l:t.replace(/\/$/,"")+l}initApplePay(t){if(!this.settings?.payment?.types?.includes("apple_pay")&&!this.settings?.payment?.applePay)return;document.head.insertAdjacentHTML("beforeend","\n    <style>\n      apple-pay-button {\n          --apple-pay-button-width: 100%;\n          --apple-pay-button-height: 20px;\n          border-radius: 4px;\n          border: solid 1px #DCDEE2;\n      }\n    </style>\n    ");const e=document.createElement("script"),n="https://applepay.cdn-apple.com/jsapi/v1.1.0/apple-pay-sdk.js";e.setAttribute("src",n),e.setAttribute("async",""),e.setAttribute("crossorigin",""),document.head.appendChild(e),this.populateApplePayBtn(t)}populateApplePayBtn(t){this.applePay.btn=document.createElement("apple-pay-button"),this.applePay.btn.setAttribute("buttonstyle","white"),this.applePay.btn.setAttribute("type","pay"),this.applePay.btn.setAttribute("locale","en-US"),this.applePay.btn.onclick=this.clickApplePay,t.appendChild(this.applePay.btn)}hideAutoPayButtons(t){""!==t&&"apple_pay"!==t?(this.applePay.btn?.remove(),this.applePay.btn=null):this.waitForContainer(this.container,(t=>{t&&(this.applePay.btn||this.populateApplePayBtn(t))}))}isSurchargeable(t,e){const n=["CO","CT","ME","MA"];return""!==t&&(-1===n.indexOf(t.toUpperCase())&&!(!e||!e.card_type||"credit"!==e.card_type.toLowerCase()))}submit(t){this.getGuardianData().then((t=>{t.events?.length&&this.postMessage({event:"setGuardian",data:t})})).then((()=>{this.postMessage({event:"submit",data:{amount:t}})})).catch((()=>{this.postMessage({event:"submit",data:{amount:t}})}))}setExpDate(t){this.postMessage({event:"setExpDate",data:{value:t}})}setError(t){this.postMessage({event:"setError",data:{input:t}})}postMessage(t){const e=this.iframe.contentWindow;if(null!==e){const n=JSON.stringify(t);e.postMessage(n,"*")}}uuid(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()}waitForContainer(t,e){if(!t)return void e(null);const n=Date.now(),i=1e3,a=1e4;(function s(){"string"!==typeof t||null===document.querySelector(t)?"string"!==typeof t&&t?e(t):setTimeout((()=>{a&&Date.now()-n>a?e(null):s()}),i):e(document.querySelector(t))})()}buildIframe(){const t=document.createElement("iframe");return t.src=this.getApiKeyURL(),t.setAttribute("allow","payment"),t.style.display="block",t.style.border="none",t.style.margin="0px",t.style.padding="0px",t.style.width="1px",t.style.minWidth="100%",t.style.height="30px",t.style.overflow="hidden",t.style.backgroundColor="transparent",t.style.transition="all .3s ease-out",t.frameBorder="0",t}setSettings(t){this.postMessage({event:"setSettings",data:t})}updateHeight(t){t&&(this.iframe.style.height=t+"px")}getGuardianData(){const t=window.Guardian;return t&&t.getData&&"function"===typeof t.getData?t.getData():Promise.reject()}messageListener(t){try{const e=JSON.parse(t.data),n=e.id;if(this.id!==n)return;const i=e.event,a=e.data;if(!i)return;switch(i){case"submission":this.submission(a);break;case"validCard":this.validCard(a);break;case"achOnChange":this.achOnChange(a);break;case"magStripeSwipe":this.magStripeSwipe(a);break;case"onPaymentChange":this.onPaymentChange(a.type),this.hideAutoPayButtons(a.type);break;case"setHeight":this.updateHeight(a.height);break}}catch(t){}}}},601:function(t,e,n){n.r(e),n.d(e,{default:function(){return y}});var i=n(252),a=n(577);const s={class:"threeds"},r=(0,i._)("pre",null,[(0,i.Uk)("      "),(0,i._)("code",{class:"language-javascript"},"\n        // Tokenizer\n        var tokenizer = new Tokenizer({\n          // url: Optional - used only when the domain does not match\n          apikey: \"api_12345\",\n          settings: {\n            payment: {\n              types: ['stripe'],\n              stripe: {\n                // https://stripe.com/docs/stripe-js/appearance-api\n                appearance: {\n                  theme: 'night',\n                  variables: {},\n                  rules: {}\n                }\n              }\n            }\n          },\n          container: document.querySelector(\".tokenizer-container\"),\n          submission: (response) => {\n            // set the response\n            state.response = response\n          }\n        })\n\n        // Submit\n        var submit = function() {\n          // submit off to the tokenizer with the dollar amount\n          tokenizer.submit()\n        }\n      "),(0,i.Uk)("\n    ")],-1),o={class:"playground example"},p={ref:"example",class:"payment"};function l(t,e,n,l,u,h){return(0,i.wg)(),(0,i.iD)("div",s,[r,(0,i._)("div",o,[(0,i._)("div",p,null,512),(0,i._)("button",{id:"submit",type:"button",class:"button",onClick:e[0]||(e[0]=e=>t.submit())}," Checkout "),(0,i._)("pre",null,(0,a.zw)(t.response),1)])])}var u=n(430),h=n(507),c=(0,i.aZ)({name:"Stripe",data(){return{example:{},response:null}},mounted(){this.example=new u.Z({apikey:h.K,container:this.$refs.example,settings:{payment:{types:["stripe"],stripe:{appearance:{theme:"night",variables:{},rules:{}}}}},submission:t=>{this.response=t}})},methods:{submit(){this.example.submit()}}}),d=n(744);const m=(0,d.Z)(c,[["render",l]]);var y=m}}]);
//# sourceMappingURL=601.9a710240.js.map